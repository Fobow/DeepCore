================== Exp 0 ==================
dataset: CIFAR10, model: ResNet18, selection: Uniform, num_ex: 1, epochs: 1, fraction: 0.1, seed: 49489, lr: 0.1, save_path: ./result, resume: , device: cuda, checkpoint_name: CIFAR10_ResNet18_Uniform_exp0_epoch1_2024-03-18 12:29:11.358835_0.1_
Files already downloaded and verified
Files already downloaded and verified
=>number of samples:  5000
=> Saving checkpoint for epoch 0, with Prec@1 0.000000.
Epoch: [0][0/40]	Time 4.841 (4.841)	Loss 2.4943 (2.4943)	Prec@1 10.156 (10.156)
Traceback (most recent call last):
  File "/home/yancheng/code/DeepCore/main.py", line 340, in <module>
    main()
  File "/home/yancheng/code/DeepCore/main.py", line 282, in main
    train(train_loader, network, criterion, optimizer, scheduler, epoch, args, rec, if_weighted=if_weighted)
  File "/home/yancheng/code/DeepCore/utils.py", line 71, in train
    wandb.log({'epoch': epoch, 'train_loss': losses.avg, 'val_loss': losses.val,"train_acc": top1.avg, "val_acc": top1.val, "lr": scheduler.get_last_lr()[0],
  File "/home/yancheng/.local/lib/python3.10/site-packages/wandb/sdk/wandb_run.py", line 420, in wrapper
    return func(self, *args, **kwargs)
  File "/home/yancheng/.local/lib/python3.10/site-packages/wandb/sdk/wandb_run.py", line 371, in wrapper_fn
    return func(self, *args, **kwargs)
  File "/home/yancheng/.local/lib/python3.10/site-packages/wandb/sdk/wandb_run.py", line 361, in wrapper
    return func(self, *args, **kwargs)
  File "/home/yancheng/.local/lib/python3.10/site-packages/wandb/sdk/wandb_run.py", line 1820, in log
    self._log(data=data, step=step, commit=commit)
  File "/home/yancheng/.local/lib/python3.10/site-packages/wandb/sdk/wandb_run.py", line 1595, in _log
    self._partial_history_callback(data, step, commit)
  File "/home/yancheng/.local/lib/python3.10/site-packages/wandb/sdk/wandb_run.py", line 1467, in _partial_history_callback
    self._backend.interface.publish_partial_history(
  File "/home/yancheng/.local/lib/python3.10/site-packages/wandb/sdk/interface/interface.py", line 570, in publish_partial_history
    item.value_json = json_dumps_safer_history(v)
  File "/home/yancheng/.local/lib/python3.10/site-packages/wandb/util.py", line 839, in json_dumps_safer_history
    return dumps(obj, cls=WandBHistoryJSONEncoder, **kwargs)
  File "/usr/lib/python3.10/json/__init__.py", line 238, in dumps
    **kw).encode(obj)
  File "/usr/lib/python3.10/json/encoder.py", line 199, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/usr/lib/python3.10/json/encoder.py", line 257, in iterencode
    return _iterencode(o, 0)
  File "/home/yancheng/.local/lib/python3.10/site-packages/wandb/util.py", line 804, in default
    return json.JSONEncoder.default(self, obj)
  File "/usr/lib/python3.10/json/encoder.py", line 179, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
TypeError: Object of type AverageMeter is not JSON serializable
Traceback (most recent call last):
  File "/home/yancheng/code/DeepCore/main.py", line 340, in <module>
    main()
  File "/home/yancheng/code/DeepCore/main.py", line 282, in main
    train(train_loader, network, criterion, optimizer, scheduler, epoch, args, rec, if_weighted=if_weighted)
  File "/home/yancheng/code/DeepCore/utils.py", line 71, in train
    wandb.log({'epoch': epoch, 'train_loss': losses.avg, 'val_loss': losses.val,"train_acc": top1.avg, "val_acc": top1.val, "lr": scheduler.get_last_lr()[0],
  File "/home/yancheng/.local/lib/python3.10/site-packages/wandb/sdk/wandb_run.py", line 420, in wrapper
    return func(self, *args, **kwargs)
  File "/home/yancheng/.local/lib/python3.10/site-packages/wandb/sdk/wandb_run.py", line 371, in wrapper_fn
    return func(self, *args, **kwargs)
  File "/home/yancheng/.local/lib/python3.10/site-packages/wandb/sdk/wandb_run.py", line 361, in wrapper
    return func(self, *args, **kwargs)
  File "/home/yancheng/.local/lib/python3.10/site-packages/wandb/sdk/wandb_run.py", line 1820, in log
    self._log(data=data, step=step, commit=commit)
  File "/home/yancheng/.local/lib/python3.10/site-packages/wandb/sdk/wandb_run.py", line 1595, in _log
    self._partial_history_callback(data, step, commit)
  File "/home/yancheng/.local/lib/python3.10/site-packages/wandb/sdk/wandb_run.py", line 1467, in _partial_history_callback
    self._backend.interface.publish_partial_history(
  File "/home/yancheng/.local/lib/python3.10/site-packages/wandb/sdk/interface/interface.py", line 570, in publish_partial_history
    item.value_json = json_dumps_safer_history(v)
  File "/home/yancheng/.local/lib/python3.10/site-packages/wandb/util.py", line 839, in json_dumps_safer_history
    return dumps(obj, cls=WandBHistoryJSONEncoder, **kwargs)
  File "/usr/lib/python3.10/json/__init__.py", line 238, in dumps
    **kw).encode(obj)
  File "/usr/lib/python3.10/json/encoder.py", line 199, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/usr/lib/python3.10/json/encoder.py", line 257, in iterencode
    return _iterencode(o, 0)
  File "/home/yancheng/.local/lib/python3.10/site-packages/wandb/util.py", line 804, in default
    return json.JSONEncoder.default(self, obj)
  File "/usr/lib/python3.10/json/encoder.py", line 179, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
TypeError: Object of type AverageMeter is not JSON serializable